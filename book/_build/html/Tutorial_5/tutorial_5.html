
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tutorial 5 &#8212; Scientific Computing Workbook</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Practice 6" href="../Tutorial_6/practice_6.html" />
    <link rel="prev" title="Practice 5" href="practice_5.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/nsci0007_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Scientific Computing Workbook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Scientific Computing Workbook
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Before_you_begin/getting_started.html">
   Before You Begin
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_1/practice_1.html">
   Practice 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_1/tutorial_1.html">
   Tutorial 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_2/practice_2.html">
   Practice 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_2/tutorial_2.html">
   Tutorial 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_3/practice_3.html">
   Practice 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_3/tutorial_3.html">
   Tutorial 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_4/practice_4.html">
   Practice 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_4/tutorial_4.html">
   Tutorial 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="practice_5.html">
   Practice 5
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Tutorial 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_6/practice_6.html">
   Practice 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_6/tutorial_6.html">
   Tutorial 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_7/practice_7.html">
   Practice 7
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tutorial_7/tutorial_7.html">
   Tutorial 7
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Tutorial_5/tutorial_5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-1">
   Question 1
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-2">
   Question 2
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="tutorial-5">
<h1>Tutorial 5<a class="headerlink" href="#tutorial-5" title="Permalink to this headline">¶</a></h1>
<div class="section" id="question-1">
<h2>Question 1<a class="headerlink" href="#question-1" title="Permalink to this headline">¶</a></h2>
<p>The (approximate) orbit of a planet around the sun is given by the following equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x = d\cos(2\pi t/p)\\
 y = d\sin(2\pi t/p)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(d\)</span> is the distance from the sun, and <span class="math notranslate nohighlight">\(p\)</span>  is the orbital period in days.</p>
<p>Values for <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(p\)</span> for the Solar System can be found in the following link:</p>
<p><a class="reference external" href="http://www.astronomynotes.com/tables/tablesb.htm">http://www.astronomynotes.com/tables/tablesb.htm</a></p>
<div class="sidebar">
<p class="sidebar-title">Animation Code</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">animation</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># Parabolic Trajectory</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">25</span> <span class="o">-</span> <span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Animation code:</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;animation.gif&quot;</span>
<span class="n">frames</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">interval</span> <span class="o">=</span> <span class="mi">100</span>

<span class="k">def</span> <span class="nf">ganimate</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">frame</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">frame</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ganimate</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
<span class="n">anim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="s1">&#39;imagemagick&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">__counter__</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">2e9</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;img src=&quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="n">__counter__</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<ol class="simple">
<li><p>Create an array <code class="docutils literal notranslate"><span class="pre">t</span></code> containing the 365 days of the year then calculate the trajectory of planet Earth’s orbit around the sun for one (Earth) year. Plot a graph showing <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> against <span class="math notranslate nohighlight">\(t\)</span>, and  another graph showing <span class="math notranslate nohighlight">\(y\)</span> against <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Calculate the trajectories of the four innermost planets around the sun, and add their trajectories to the two graphs (of course you’ll have to increase the simulation duration). [hint: you could create separate variables <code class="docutils literal notranslate"><span class="pre">x_earth</span></code>, <code class="docutils literal notranslate"><span class="pre">y_earth</span></code>, <code class="docutils literal notranslate"><span class="pre">x_mercury</span></code>, <code class="docutils literal notranslate"><span class="pre">y_mercury</span></code> etc, but it is neater to make two 2-dimensional arrays <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> where each row corresponds to a planet].</p></li>
<li><p>Adapt the animation code to generate an animation of the orbits of the four planets. [Hint: generating the animation can be quite slow, so start by reducing the number elements in your array <code class="docutils literal notranslate"><span class="pre">t</span></code> by increasing the timestep]</p></li>
</ol>
</div>
<div class="section" id="question-2">
<h2>Question 2<a class="headerlink" href="#question-2" title="Permalink to this headline">¶</a></h2>
<p>The spread of an infectious disease amongst a population can be modelled by the SIR model. The number of susceptible (<span class="math notranslate nohighlight">\(S_i\)</span>) and infected (<span class="math notranslate nohighlight">\(I_i\)</span>) peeople are modelled by the following pair of coupled equations:</p>
<div class="math notranslate nohighlight">
\[ S_{i+1} = S_i - bS_iI_i \]</div>
<div class="math notranslate nohighlight">
\[ I_{i+1} = I_i + bS_iI_i - aI_i \]</div>
<p>where <span class="math notranslate nohighlight">\(i\)</span> represents the number of days since the start of the outbreak. There are two parameters: the recovery rate parameter <span class="math notranslate nohighlight">\(a\)</span> and the infection rate parameter <span class="math notranslate nohighlight">\(b\)</span>.</p>
<ol class="simple">
<li><p>With parameter values <span class="math notranslate nohighlight">\(a = 0.1\)</span> and <span class="math notranslate nohighlight">\(b = 0.00005\)</span> and the initial populations <span class="math notranslate nohighlight">\(S_0 = 20000\)</span> and <span class="math notranslate nohighlight">\(I_0 = 100\)</span>, simulate the infection for a duration 100 days. Plot the resulting arrays <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">I</span></code> on the same figure. [You should see that the number of infected people peaks at around 15000 at about day 15, while the number of susceptible people drops to about zero at about the same time].</p></li>
</ol>
<p>The number of recovered people <span class="math notranslate nohighlight">\(R_i\)</span> is given by <span class="math notranslate nohighlight">\(P = S_i + I_i + R_i\)</span> where the total population <span class="math notranslate nohighlight">\(P\)</span> is a constant.</p>
<ol class="simple">
<li><p>Given the total population <span class="math notranslate nohighlight">\(P = S_0 + I_0\)</span>, calculate an array <code class="docutils literal notranslate"><span class="pre">R</span></code> representing the number of recovered people over the 100 days. Plot <code class="docutils literal notranslate"><span class="pre">R</span></code> on the graph together with <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">I</span></code>.</p></li>
</ol>
<p>The infection rate parameter <span class="math notranslate nohighlight">\(b\)</span> can be influenced by public policy - for example the imposition of social distancing, vaccination or other measures.</p>
<ol class="simple">
<li><p>Experiment with various values of <span class="math notranslate nohighlight">\(b\)</span> to see how it affects the outbreak. Roughly what is the minimum value of <span class="math notranslate nohighlight">\(b\)</span> which results in an epidemic? (We say there is an epidemic if <span class="math notranslate nohighlight">\(I_i\)</span> initially rises to a peak, however small).</p></li>
</ol>
<p>The Government would like to understand how <span class="math notranslate nohighlight">\(b\)</span> affects the the peak value of <span class="math notranslate nohighlight">\(I_i\)</span>.</p>
<ol class="simple">
<li><p>Write a function <code class="docutils literal notranslate"><span class="pre">max_I(a,</span> <span class="pre">b)</span></code> which runs the simulation with the given values for the parameters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> and returns the maximum value of <code class="docutils literal notranslate"><span class="pre">I_i</span></code>. Then, write a loop which calculates <code class="docutils literal notranslate"><span class="pre">max_I(a,</span> <span class="pre">b)</span></code> for values of <code class="docutils literal notranslate"><span class="pre">b</span></code> ranging from 0.0 to 0.00005. Plot a graph showing peak <span class="math notranslate nohighlight">\(I_i\)</span> against <span class="math notranslate nohighlight">\(b\)</span>.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">max_I</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    
    <span class="c1"># run the simulation for parameter values a, b</span>
    
    <span class="c1"># return maximum value of I</span>
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Tutorial_5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="practice_5.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Practice 5</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../Tutorial_6/practice_6.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Practice 6</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Natural Sciences<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>